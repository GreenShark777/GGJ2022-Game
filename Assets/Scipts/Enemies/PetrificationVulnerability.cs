//Rende vulnerabile alla 
using UnityEngine;

public class PetrificationVulnerability : MonoBehaviour
{
    //array di riferimenti a tutti gli script da disabilitare per la pietrificazione
    [SerializeField]
    private MonoBehaviour[] scriptsToStop = default;
    //riferimento allo SpriteRenderer di quest'entità
    [SerializeField]
    private SpriteRenderer sr = default;
    //riferimento allo sprite di pietrificazione
    [SerializeField]
    private Sprite petrifiedSprite = default;
    //indica se si è vulnerabili alla pietrificazione
    [SerializeField]
    private bool isVulnerable = false;


    /// <summary>
    /// Pietrifica quest'entità se vulnerabile
    /// </summary>
    public void TryToPetrify()
    {
        //se vulnerabile...
        if (isVulnerable)
        {
            //...disabilita ogni script nell'array...
            foreach (MonoBehaviour script in scriptsToStop) { script.enabled = false; }
            //...e cambia lo sprite con quello da pietrificato
            if (sr && petrifiedSprite) sr.sprite = petrifiedSprite;
            else { Debug.LogError("Impossibile cambiare sprite per pietrificazione a: " + name); }

            Debug.LogError("Pietrificato: " + name);
        }
        else { Debug.LogError("Non era vulnerabile, e non è stato pietrificato: " + name); }

    }
    /// <summary>
    /// Permette di cambiare lo stato di vulnerabilità alla pietrificazione
    /// </summary>
    /// <param name="state"></param>
    public void SetVulnerabilityState(bool state) { isVulnerable = state; }

}
